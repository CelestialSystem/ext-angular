# Adding ExtAngular to an Existing Angular Application

The guides provides the steps necessary to add ExtAngular to an existing Angular application.

## Requirements

ExtAngular requires the following:

* Node 8.11+
* NPM 6+
* Angular 7+
* Webpack 4+
* Java 8 *


## Installing ExtAngular Packages from NPM

*Note: you must be signed into the Sencha NPM registry to access the ExtReact packages. See [Authenticating to Sencha's NPM Registry](getting_started.html#getting_started_-_authenticating_to_sencha_s_npm_registry) for more information.*

Run the following commands to install ExtReact and its dependencies:

```bash
npm install --save @sencha/ext-react
npm install --save @sencha/ext @sencha/ext-modern @sencha/ext-modern-theme-material
npm install --save-dev @sencha/ext-react-webpack-plugin @sencha/ext-react-babel-plugin html-webpack-plugin
```

ExtReact also provides a number of optional packages [listed here](packages.html)

## Configuring Webpack

ExtReact requires a webpack plugin to bundle and optimize the ExtReact components you use in your application.  Add it to your webpack config as follows:

```javascript
// import the plugins
const HtmlWebpackPlugin = require('html-webpack-plugin')
const ExtReactWebpackPlugin = require('@sencha/ext-react-webpack-plugin');
...

// then, in your webpack config options:
return {
  plugins: [
    new HtmlWebpackPlugin({
      template: 'index.html',
      hash: true
    }), 
    new ExtReactWebpackPlugin({
      port:port,
    }) 
  ]
}
```

*Note: If you're using `html-webpack-plugin`, make sure it comes before `ExtReactWebpackPlugin` in the plugins array so that tags for ext.js and ext.css are included in the resulting index.html.*

If using webpack-dev-server, make sure that the build directory is in the `contentBase` config.  

```
contentBase: "./build"
```

If `contentBase` is set to another directory, you can change the value to an array and add "build":

```
contentBase: ["static", "./build"]
```

For more information on configuring the ExtReactWebpackPlugin, see [Building with Webpack](webpack_and_babel.html).

You can also use the [webpack configuration file in the ExtReact Modern Boilerplate](https://github.com/sencha/ext-react/blob/master/packages/ext-react-modern-boilerplate/webpack.config.js) for reference

## Configuring Babel

In order to build your application, `@sencha/ext-react-babel-plugin` must be included in your babel configuration and __ES6 module transpilation must be turned off__.  Here is an example .babelrc:

```javascript
{
  "presets": [
    [ "es2015", { "modules": false } ],
    "stage-2",
    "react"
  ],
  "plugins": [
    "@sencha/ext-react-babel-plugin"
  ]
}
```

*Note: disabling ES6 module transpilation in babel doesn't prevent you from using `import` statements. It just defers the processing of those statements to Webpack, which enables tree-shaking and will help descrease the size of your application bundle.*

## Updating index.html

If you're using `html-webpack-plugin`, the JavaScript and CSS resources generated by `ExtReactWebpackPlugin` will automatically be added to your index.html file at build time.  If not, you'll need to add them manually:

```html
<!doctype html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link href="ext-react/ext.css" rel="stylesheet">
    ...
</head>
<body>
    ...
    <script type="text/javascript" src="ext-react/ext.js"></script>
    ...
</body>
```

### HTML Doctype

The HTML5 doctype declaration is required for ExtReact components to display properly.  Please make sure that this declaration is present at the top of your HTML document:

```html
<!doctype html>
```

### Viewport Meta Tag

ExtReact requires a viewport meta tag.  This should be added to the `<head>` element in your index.html.

```html
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
```

## Launching your Application

The `@sencha/ext-react` package provides a `launch` function to using instead of `ReactDOM.render()`:

### `launch(React.Element/Function)`

To launch your app, add the following to your index.js file (your webpack entry point):
When using with React v16 and above, developers need to add a new component called      ExtReact at the root before using Ext JS component. Best way is to add it at the applicationâ€™s entry point or launch method and then ExtJS Component can be used anywhere throughout application.


```javascript
import { launch } from '@sencha/ext-react';
import { ExtReact } from '@sencha/ext-react'

import App from './App';

launch(<ExtReact><App/><ExtReact>);
```

The launch function renders the specified component into the document body. It also accepts a callback function that returns the component to be rendered:

```javascript
launch(() => {
  // do some initialization before initial render
  // ...
  
  // return the component to be rendered
  return <App/>;
})
```

The `launch` function serves two purposes:

1. It delays your App's initial render until the ExtReact class system is fully initialized
2. It creates a viewport, which is needed for creating components that take up the full height and width of the screen. 

When using `launch` you do not need a separate target `<div id="root"/>` in your `index.html` file. If you have one you 
should remove it. The code above replaces the typical code for launching a React app, which generally looks something like:

```javascript
import ReactDOM from 'react-dom';
import App from './App';

ReactDOM.render(<App/>, document.getElementById('root'));
```    

### renderWhenReady(Component)

If you do not need to create fullscreen components (for example if you're using ExtReact components with another layout system), you can apply the `renderWhenReady` higher-order component to topmost component containing an ExtReact element, omit the launch function, and render to a target element as is customary with React.  This is especially useful if you're building a library of components based on ExtReact and you don't want to require the applications that use your library to call `launch`.

```jsx
// App.js
import React, { Component } from 'react';
import { Panel } from '@sencha/ext-modern';
import { renderWhenReady } from '@sencha/ext-react';

class App extends Component {
    render() {
        return (
            <Panel title="ExtReact">Hello World!</Panel>
        )
    }
}

export default renderWhenReady(App);
```

```jsx
// index.js
import ReactDOM from 'react-dom';
import App from './App';

ReactDOM.render(<App/>, document.getElementById('root'));
```

### React Hot Loader

Here is an example that uses the launch function's callback parameter to enable react-hot-loader.  The callback is passed a DOM element that can be used as the target when calling `ReactDOM.render`.

```javascript
import React from 'react'
import ReactDOM from 'react-dom'
import { AppContainer } from 'react-hot-loader'
import { launch } from '@sencha/ext-react';
import { ExtReact } from '@sencha/ext-react'
import App from './App'

let viewport;

const render = (Component, target) => {
    ReactDOM.render(
        <ExtReact>
            <AppContainer>
                <Component/>
            </AppContainer>
        </ExtReact>,
        target
    )
}

launch(target => render(App, viewport = target));

if (module.hot) {
    module.hot.accept('./App', () => render(App, viewport));
}
```

## The `fullscreen` config

Most apps that use ExtReact are single-page applications that occupy the full height and width of the browser window.  To acheive this, the root ExtReact component in your app should be configured with the `fullscreen` prop set to `true`.  For example:

```javascript
import { Container } from '@sencha/ext-modern';

export default function App() {
  return (
    <Container fullscreen>
      ...
    </Container>
  )
}
```

## ESLint

If you're using ESLint, add `Ext` as an allowed global:

```javascript
"globals": {
    "Ext": true
}
```

## Help Me, I'm Stuck!

We realize that React apps and build configurations vary greatly from project to project.  If you get stuck, come ask for help in the [ExtReact Q&A Forum](https://www.sencha.com/forum/forumdisplay.php?159-Q-amp-A).
