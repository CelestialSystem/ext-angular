<container  layout="fit" padding="10" [fitToParent]="true">

  <toolbar docked="top" ui="app-transparent-toolbar" [shadow]="false" [margin]="isPhone? '0 10' : '10 0 0 10'" padding="0 10 0 10"
    [defaults]="{margin: '0 10 0 0',shadow: true,ui: 'action'}">
    <button text="Configurator" [handler]="this.showConfigurator"></button>
    <button text="Export to ...">
      <menu [defaults]="{ handler: this.exportDocument, iconCls: 'x-fa fa-file-text-o' }">
        <menuitem
          text="Excel xlsx (pivot table definition)" 
          iconCls="x-fa fa-file-excel-o"
          [config]="{type: 'pivotxlsx',matrix: true,fileName: 'ExportPivot.xlsx'}">
        </menuitem>
        <menuitem
          text="Excel xlsx (all items)"
          iconCls="x-fa fa-file-excel-o"
          [config]="{type: 'excel07',fileName: 'ExportAll.xlsx'}">
        </menuitem>
        <menuitem
          text="Excel xlsx (visible items)"
          iconCls="x-fa fa-file-excel-o"
          [config]="{type: 'excel07',fileName: 'ExportVisible.xlsx',onlyExpandedNodes: true}">
        </menuitem>
        <menuitem
          text="Excel xml (all items)"
          iconCls="x-fa fa-file-excel-o"
          [config]="{type: 'excel03',fileName: 'ExportAll.xml'}">
        </menuitem>
        <menuitem
          text="Excel xml (visible items)"
          iconCls="x-fa fa-file-excel-o"
          [config]="{type: 'excel03',fileName: 'ExportVisible.xml',onlyExpandedNodes: true}">
        </menuitem>
        <menuitem
          text="CSV (all items)"
          [config]="{type: 'csv',fileName: 'ExportAll.csv'}">
        </menuitem>
        <menuitem
          text="CSV (visible items)"
          [config]="{type: 'csv',fileName: 'ExportVisible.csv',onlyExpandedNodes: true}">
        </menuitem>
        <menuitem 
          text="TSV (all items)"
          [config]="{type: 'tsv',fileName: 'ExportAll.csv'}">
        </menuitem>
        <menuitem 
          text="TSV (visible items)"
          [config]="{type: 'tsv',fileName: 'ExportVisible.csv',onlyExpandedNodes: true}">
        </menuitem>
        <menuitem 
          text="HTML (all items)"
          iconCls="x-fa fa-html5"
          [config]="{type: 'html',fileName: 'ExportAll.html'}">
        </menuitem>
        <menuitem 
          text="HTML (visible items)"
          iconCls="x-fa fa-html5"
          [config]="{type: 'html',fileName: 'ExportVisible.html',onlyExpandedNodes: true}">
        </menuitem>
      </menu>
    </button>
  </toolbar>

  <pivotgrid 
    [shadow]="true"
    [plugins]="pivotgridPlugins"
    [matrix]="pivotGridMatrix"
    (ready)="onPivotGridRead($event)"
    (onDocumentSave)="this.onDocumentSave"
    (onBeforeDocumentSave)="this.onBeforeDocumentSave">
  </pivotgrid>

</container>