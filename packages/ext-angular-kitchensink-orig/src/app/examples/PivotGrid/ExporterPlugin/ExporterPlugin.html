<ext-container layout="fit" padding="10" [fitToParent]="true">
    <ext-toolbar
        docked="top"
        ui="app-transparent-toolbar"
        [shadow]="false"
        [margin]="isPhone ? '0 10' : '10 0 0 10'"
        padding="0 10 0 10"
        [defaults]="{ margin: '0 10 0 0', shadow: true, ui: 'action' }"
    >
        <ext-button
            text="Configurator"
            [handler]="this.showConfigurator"
        ></ext-button>
        <ext-button text="Export to ...">
            <ext-menu
                [defaults]="{
                    handler: this.exportDocument,
                    iconCls: 'x-fa fa-file-text-o'
                }"
            >
                <ext-menuitem
                    text="Excel xlsx (pivot table definition)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{
                        type: 'pivotxlsx',
                        matrix: true,
                        fileName: 'ExportPivot.xlsx'
                    }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="Excel xlsx (all items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{ type: 'excel07', fileName: 'ExportAll.xlsx' }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="Excel xlsx (visible items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{
                        type: 'excel07',
                        fileName: 'ExportVisible.xlsx',
                        onlyExpandedNodes: true
                    }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="Excel xml (all items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{ type: 'excel03', fileName: 'ExportAll.xml' }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="Excel xml (visible items)"
                    iconCls="x-fa fa-file-excel-o"
                    [config]="{
                        type: 'excel03',
                        fileName: 'ExportVisible.xml',
                        onlyExpandedNodes: true
                    }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="CSV (all items)"
                    [config]="{ type: 'csv', fileName: 'ExportAll.csv' }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="CSV (visible items)"
                    [config]="{
                        type: 'csv',
                        fileName: 'ExportVisible.csv',
                        onlyExpandedNodes: true
                    }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="TSV (all items)"
                    [config]="{ type: 'tsv', fileName: 'ExportAll.csv' }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="TSV (visible items)"
                    [config]="{
                        type: 'tsv',
                        fileName: 'ExportVisible.csv',
                        onlyExpandedNodes: true
                    }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="HTML (all items)"
                    iconCls="x-fa fa-html5"
                    [config]="{ type: 'html', fileName: 'ExportAll.html' }"
                >
                </ext-menuitem>
                <ext-menuitem
                    text="HTML (visible items)"
                    iconCls="x-fa fa-html5"
                    [config]="{
                        type: 'html',
                        fileName: 'ExportVisible.html',
                        onlyExpandedNodes: true
                    }"
                >
                </ext-menuitem>
            </ext-menu>
        </ext-button>
    </ext-toolbar>

    <ext-pivotgrid
        [shadow]="true"
        [plugins]="pivotgridPlugins"
        [matrix]="pivotGridMatrix"
        (ready)="onPivotGridRead($event)"
        (onDocumentSave)="(this.onDocumentSave)"
        (onBeforeDocumentSave)="(this.onBeforeDocumentSave)"
    >
    </ext-pivotgrid>
</ext-container>
